This SQL Program reviews all the knowledge learned in Data Analytics and Business Intelligence TechSkills Program at Bow Valley College

use review
go

select * from summary

/*-- check for duplicates --*/
select distinct studentID from summary

/*-- check for duplicates --*/
select studentID,
count (*) AS DUP
from summary
group by studentID
having COUNT (*) > 1

select studentID, First_name, Lastname, Midtermexam, Finalexam, assignment1, assignment2, Grade,
count (*) AS DUP
from summary
group by studentID, First_name, Lastname, Midtermexam, Finalexam, assignment1, assignment2, Grade
having COUNT (*) > 1

select studentID, First_name, Lastname into studentinfo from summary
select studentID, Midtermexam, Finalexam, assignment1, assignment2 into marks from summary
select studentID, Grade into FinalGrade from summary

select * from studentinfo
select * from marks
select * from FinalGrade

drop table marks
drop table FinalGrade

ALTER table studentinfo ADD Constraint PK_studentinfo PRIMARY KEY (studentID)

ALTER table marks ADD FOREIGN KEY (studentID) references studentinfo (studentID)
ALTER table FinalGrade ADD FOREIGN KEY (studentID) references studentinfo (studentID)

select * from FinalGrade
select * from marks
select * from studentinfo

/*-- example join to make new table --*/
select studentID, First_name, Lastname into example
from studentinfo full outer join marks
on studentinfo.studentID = marks.studentID
from 2nd full outer joing 3rd
on marks.studentId = FinalGrade.studentID

select studentinfo.First_name, marks.Midtermexam
from studentinfo inner join marks
on studentinfo.studentID = marks.studentID

select studentinfo.First_name, studentinfo.Lastname, marks.Midtermexam, marks.Finalexam, marks.assignment1, marks.assignment2
from studentinfo inner join marks
on  studentinfo.studentID = marks.studentID

select studentinfo.First_name, studentinfo.Lastname, FinalGrade.Grade
from studentinfo inner join FinalGrade
on studentinfo.studentID = FinalGrade.studentID

/*-- example join to make new table --*/
select studentID, First_name, Lastname into example
from studentinfo full outer join marks
on studentinfo.studentID = marks.studentID
from 2nd full outer join 3rd
on marks.studentId = FinalGrade.studentID

select studentinfo.studentID, studentinfo.First_name, studentinfo.Lastname
from studentinfo full outer join marks
on studentinfo.studentID = marks.studentID

/*-- works join studentinfo and marks --*/
select studentinfo.studentID, studentinfo.First_name, studentinfo.Lastname, marks.Midtermexam, marks.Finalexam, marks.assignment1, marks.assignment2
from studentinfo full outer join marks
on studentinfo.studentID = marks.studentID

/*-- works join marks and FinalGrade --*/
select marks.Midtermexam, marks.Finalexam, marks.assignment1, marks.assignment2, FinalGrade.Grade
from marks full outer join FinalGrade
on marks.studentID = FinalGrade.studentID

/*-- works with all 3 tables --*/
select studentinfo.studentID, studentinfo.First_name, studentinfo.Lastname, marks.Midtermexam, marks.Finalexam, marks.assignment1, marks.assignment2, FinalGrade.Grade
from studentinfo inner join marks on studentinfo.studentID = marks.studentID
inner join FinalGrade on studentinfo.studentID = FinalGrade.studentID

select studentinfo.studentID, studentinfo.First_name, studentinfo.Lastname, marks.Midtermexam, marks.Finalexam, marks.assignment1, marks.assignment2, FinalGrade.Grade into report1
from studentinfo inner join marks on studentinfo.studentID = marks.studentID
inner join FinalGrade on studentinfo.studentID = FinalGrade.studentID

select * from report1

/*-- show everything inner join studentinfo and marks then inner join studentinfo and FinalGrade --*/
select studentinfo.studentID, studentinfo.First_name, studentinfo.Lastname, marks.Midtermexam, marks.Finalexam, marks.assignment1, marks.assignment2, FinalGrade.Grade
from studentinfo inner join marks on studentinfo.studentID = marks.studentID
inner join FinalGrade on studentinfo.studentID = FinalGrade.studentID
order by studentinfo.studentID

/*-- inner join studentinfo and marks --*/
select studentinfo.studentID, studentinfo.First_name, studentinfo.Lastname, marks.Midtermexam, marks.Finalexam, marks.assignment1, marks.assignment2, FinalGrade.Grade
from studentinfo inner join marks on studentinfo.studentID = marks.studentID

/*-- inner join studentinfo and FinalGrade --*/
select studentinfo.studentID, studentinfo.First_name, studentinfo.Lastname,FinalGrade.Grade
from studentinfo inner join FinalGrade on studentinfo.studentID = FinalGrade.studentID
order by studentinfo.studentID

/*-- make report 2 --*/
select studentinfo.studentID, studentinfo.First_name, studentinfo.Lastname, marks.Midtermexam, marks.Finalexam, marks.assignment1, marks.assignment2, FinalGrade.Grade into report2
from studentinfo inner join marks on studentinfo.studentID = marks.studentID
inner join FinalGrade on studentinfo.studentID = FinalGrade.studentID
order by studentinfo.studentID ASC

select * from report2

select studentID, Grade from report2 order by studentID DESC

select studentID, Grade from report2 where Grade between 'A' and 'C'

select studentID, Grade from report2 where Grade between 'A' and 'C' order by Grade

select studentID, Grade from report2 where Grade between 'A' and 'C' order by Grade ASC

select studentID, Grade from report2 where Grade between 'A' and 'C' order by Grade DESC

/*-- show everything full outer join studentinfo and marks then full outer join studentinfo and FinalGrade --*/
select studentinfo.studentID, studentinfo.First_name, studentinfo.Lastname, marks.Midtermexam, marks.Finalexam, marks.assignment1, marks.assignment2, FinalGrade.Grade
from studentinfo full outer join marks on studentinfo.studentID = marks.studentID
full outer join FinalGrade on studentinfo.studentID = FinalGrade.studentID

/*-- show studentID 3 times --*/
select *
from studentinfo full outer join marks on studentinfo.studentID = marks.studentID
full outer join FinalGrade on studentinfo.studentID = FinalGrade.studentID

/*-- show studentID 3 times --*/
select *
from studentinfo inner join marks on studentinfo.studentID = marks.studentID

-- the end
